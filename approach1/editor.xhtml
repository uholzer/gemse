<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN"
          "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd" >

<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:internal="http://www.andonyar.com/math/editor"
    xml:lang="de"
>

<head>
    <title>Gemse 1</title>
    <style><![CDATA[
        @namespace internal "http://www.andonyar.com/math/editor";
        div {
            background-color: rgba(255,255,255,0.7);
            color: #000;
            -moz-border-radius: 3px;
        }
        table {
            border-collapse: collapse;
        }
        *[internal|selected="editcursor"] { color: red; background-color: yellow; }
        *[internal|selected="attributeCursor"] { color: white; background-color: black; }
        *[internal|selected="parent"] { background-color: #ddd; }
        *[internal|selected="selection"] { background-color: #aaf; }
        *[internal|selected="attributeCursor selection"] { color: white; background-color: #227; }
        *[internal|selected="insertcursor"] { background-color: #ddd; }
        *[internal|function="equation"] {
            border: 1px solid black;
            text-align: center;
            font-size: x-large;
        }
        *[internal|function="treeView"] {
            border: 1px solid black;
            margin: 1px; padding: 1px 1px 5ex 1px;
            text-align: center;
            font-size: small;
        }
        *[internal|function="treeView"] div.element {
            display: inline-block;
            border: 1px solid black;
            margin: 1px; padding: 1px;
            position: relative;
            top: 5px;
            text-align: center;
        }
        *[internal|function="treeView"] div.nodeValue {
            color: blue;
            font-size: larger;
        }
        *[internal|function="attributeView"] * {
            border: 1px solid black;
        }
        *[internal|function="modeName"] {
            color: white; background-color: black;
        }
        *[internal|function="container"] {
            opacity: 0.4;
        }
        *[internal|selected="equationFocus"] {
            opacity: 1;
        }
        /**[internal|function="container"]:not([internal|selected="equationFocus"]) > * {
            display: none;
        }
        *[internal|function="container"]:not([internal|selected="equationFocus"]) *[internal|function="equation"] {
            display: block;
            font-size: small;
            color: black; background-color: white;
        }
        *[internal|function="container"]:not([internal|selected="equationFocus"]) *[internal|function="equation"] * {
            color: inherit; background-color: inherit;
        }*/
        #input {
            position: relative;
            left: 40%; 
            right: 40%;
        }
        *.edit {
            background-color: yellow;
        }
        *.insert {
            background-color: green;
        }
        *.visual {
            background-color: blue;
        }
    ]]></style>
    <script src="gemseBase.js"/>
    <script src="editMode.js"/>
    <script src="attributeMode.js"/>
    <!-- <script src="elementDescriptors.js"/> -->
    <script><![CDATA[
        var editor;

        function start() {
            editor = new GemsePEditor();
            editor.containerTemplate = document.getElementById("containerTemplate");
            editor.attachNewEquationEnvToElement(document.getElementById("equationEnv"));
            editor.inputElement = document.getElementById("input");
            editor.inputElement.focus();

            // Detach containerTemplate from document:
            editor.containerTemplate.parentNode.removeChild(editor.containerTemplate);
            editor.containerTemplate.removeAttribute("id");
        }

        /* Event processing */
        // The curent event processing is completely broken. Perhaps I
        // should use XUL right away to clean up the mess?

        function processKey(event) {
            editor.keyEvent(event);
        }

        function processInput() {
            editor.inputEvent();
        }

    ]]></script>
</head>

<body onload="start()">

<h1>Gemse 1</h1>

<form>
    <textarea id="input" onkeypress="processKey(event)" oninput="processInput()"/>
</form>

<div id="pool">

<div internal:function="container" id="equationEnv">
    <div internal:function="equation">
        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
            <mrow>
            <mrow>
                <munderover>
                    <mo>âˆ‘</mo>
                    <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow>
                    <mi>n</mi>
                </munderover>
                <msub><mi>a</mi><mi>i</mi></msub>
            </mrow>
            <mo>+</mo>
            <mroot>
                <mrow>
                    <msup>
                        <mi>x</mi>
                        <mn>2</mn>
                    </msup>
                    <mo>+</mo>
                    <mi>b</mi>
                </mrow>
                <mi>3</mi>
            </mroot>
            <mo>+</mo>
            <mfenced open="&lt;" close="&gt;" separators=",">
                <mi>a</mi>
                <mi>b</mi>
            </mfenced>
            </mrow> 
        </math>
    </div>
    <div internal:function="treeView">

    </div>
    <div internal:function="attributeView">

    </div>
    <div internal:function="modeName"></div>
    <pre internal:function="notificationDisplay"></pre>
</div>

</div>

<div internal:function="container" id="containerTemplate">
    <div internal:function="equation">
        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        </math>
    </div>
    <div internal:function="treeView">

    </div>
    <div internal:function="attributeView">

    </div>
    <div internal:function="modeName"></div>
    <pre internal:function="notificationDisplay"></pre>
</div>

</body>

</html>
